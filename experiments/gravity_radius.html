<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì‹¤í—˜ 9 - ì¤‘ë ¥ê°€ì†ë„ ì¸¡ì •2 - ë‹¨ì§„ì ì´ìš©</title>
  <link rel="stylesheet" href="../style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        processEscapes: true
      }
    });
  </script>
  <style>
    table { border-collapse: collapse; margin-top: 20px; width: 100%; max-width: 1000px; }
    th, td { border: 1px solid #aaa; padding: 6px 10px; text-align: center; }
    input[type="number"] { width: 70px; }
    .x-cell { background-color: #eee; }
    button { margin-top: 15px; padding: 6px 12px; }
  </style>
</head>
<body>

<div class="sidebar">
  <a href="../index.html">ğŸ  í™ˆ</a>
  <a href="density.html">1. ì•¡ì²´ì˜ ë°€ë„</a>
  <a href="force.html">2. í˜ì˜ í•©ì„±ê³¼ ë¶„í•´</a>
  <a href="sound.html">3. ì†Œë¦¬ ì†ë„</a>
  <a href="expansion.html">4. ì„ íŒ½ì°½</a>
  <a href="glider.html">5. ê°€ì†ë„</a>
  <a href="centripetal.html">6. êµ¬ì‹¬ë ¥</a>
  <a href="bullet.html">7. íƒ„í™˜ ì†ë„</a>
  <a href="torque.html">8. íšŒì „ í‰í˜•</a>
  <a href="gravity.html" class="active">9. ì¤‘ë ¥ê°€ì†ë„</a>
  <a href="moment.html">10. ê´€ì„±ëª¨ë©˜íŠ¸</a>
</div>

<div class="content">
  <h2>ì‹¤í—˜ 9 - ì¤‘ë ¥ê°€ì†ë„ ì¸¡ì •2 - ë‹¨ì§„ì ì´ìš©</h2>
  <p><strong>ì‹¤í—˜ ëª©í‘œ:</strong> ë‹¨ì§„ìë¥¼ ì´ìš©í•˜ì—¬ ì¤‘ë ¥ê°€ì†ë„ë¥¼ ì¸¡ì •í•œë‹¤. ê·¸ë¦¬ê³  ì¤‘ë ¥ê°€ì†ë„ ì‹¤í—˜ì‹ì„ ì´ëŒì–´ ë‚¸ ì§„ìì˜ ë‹¨ì¡°í™”ìš´ë™ì„ ì´í•´í•œë‹¤. </p>

  <a href="gravity_theta.html" target="_blank" style="display:block; margin-bottom: 12px;">
    (1) ì‚¬ì¸ ì„¸íƒ€ê°€ ì‘ì„ ë•Œ ì„¸íƒ€ì™€ì˜ ë¹„êµ
  </a>
  <a href="gravity_radius.html" target="_blank" style="display:block; margin-bottom: 12px;">
    (2) êµ¬í˜• ì¶”ì˜ ë°˜ì§€ë¦„ ì¸¡ì •í•˜ê¸°
  </a>
  <a href="garvity_average.html" target="_blank" style="display:block; margin-bottom: 12px;">
    (3) ì¤‘ë ¥ê°€ì†ë„ì˜ í‰ê· ê°’ ê³„ì‚°í•˜ê¸°
  </a>

  <h3>ğŸ“Œ (2) êµ¬í˜• ì¶”ì˜ ë°˜ì§€ë¦„ ì¸¡ì •</h3>
  <table id="radiusTable">
    <tr><th>íšŒ</th><th>êµ¬í˜• ì¶”ì˜ ì§€ë¦„ (cm)</th></tr>
    <script>
      for (let i = 1; i <= 5; i++) {
        document.write(`<tr><td>${i}</td><td><input type="number" id="diameter${i}" oninput="calc()"></td></tr>`);
      }
    </script>
    <tr>
      <td class="x-cell">ì§€ë¦„ í‰ê· </td>
      <td><span id="diameterAvg">-</span></td>
    </tr>
    <tr>
      <td class="x-cell">ë°˜ì§€ë¦„ í‰ê· </td>
      <td><span id="radiusAvg">-</span></td>
    </tr>
  </table>

  <button onclick="exportToExcel()">ì—‘ì…€ë¡œ ë‚´ë³´ë‚´ê¸°</button>
</div>

<script>
function calc() {
  let sum = 0, count = 0;
  for (let i = 1; i <= 5; i++) {
    const d = parseFloat(document.getElementById("diameter" + i).value);
    if (!isNaN(d)) {
      sum += d;
      count++;
    }
  }

  const diameterAvg = count > 0 ? sum / count : null;
  document.getElementById("diameterAvg").innerText = diameterAvg !== null ? diameterAvg.toFixed(4) : "-";

  const radiusAvg = diameterAvg !== null ? diameterAvg / 2 : null;
  document.getElementById("radiusAvg").innerText = radiusAvg !== null ? radiusAvg.toFixed(4) : "-";
}

function exportToExcel() {
  const wb = XLSX.utils.book_new();
  const ws_data = [["íšŒ", "êµ¬í˜• ì¶”ì˜ ì§€ë¦„ (cm)"]];

  let sum = 0, count = 0;

  for (let i = 1; i <= 5; i++) {
    const input = document.getElementById("diameter" + i);
    const val = parseFloat(input.value);
    ws_data.push([i, isNaN(val) ? "" : val]);
    if (!isNaN(val)) {
      sum += val;
      count++;
    }
  }

  const diameterAvg = count > 0 ? sum / count : null;
  const radiusAvg = diameterAvg !== null ? diameterAvg / 2 : null;

  ws_data.push(["ì§€ë¦„ í‰ê· ", diameterAvg !== null ? diameterAvg.toFixed(4) : "-"]);
  ws_data.push(["ë°˜ì§€ë¦„ í‰ê· ", radiusAvg !== null ? radiusAvg.toFixed(4) : "-"]);

  const ws = XLSX.utils.aoa_to_sheet(ws_data);
  XLSX.utils.book_append_sheet(wb, ws, "ë°˜ì§€ë¦„ ì¸¡ì •ê°’");
  XLSX.writeFile(wb, "ì‹¤í—˜9_êµ¬í˜•ì¶”_ë°˜ì§€ë¦„_ì…ë ¥í¬í•¨.xlsx");
}
</script>

</body>
</html>